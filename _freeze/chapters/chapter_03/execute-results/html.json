{
  "hash": "0e7dca8d92c0dc8e4a30f707e82eb81b",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute: \n  echo: true\n  eval: false\n  warning: false\n---\n\n\n# Calculating substitution rates for selected Ensembl genomes\n\nHere, we will describe the code to calculate substitution rates for selected\ngenomes in Ensembl and Ensembl Genomes instances using the Bioconductor package \n*[doubletrouble](https://bioconductor.org/packages/3.18/doubletrouble)*. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(syntenet)\nlibrary(doubletrouble)\nlibrary(here)\nlibrary(tidyverse)\nlibrary(BiocParallel)\n\nset.seed(123) # for reproducibility\noptions(timeout = 1e10) # to allow download of big files\n\n# Load helper functions\nsource(here(\"code\", \"utils.R\"))\n```\n:::\n\n\n## Data loading\n\nHere, we will load the data frames of species metadata and the lists of\nduplicated gene pairs for each Ensembl instance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load metadata\nload(here(\"products\", \"result_files\", \"metadata_all.rda\"))\n\n# Load duplicates\nload(here(\"products\", \"result_files\", \"fungi_duplicates.rda\"))\nload(here(\"products\", \"result_files\", \"plants_duplicates.rda\"))\n```\n:::\n\n\n## Calculating substitution rates\n\nNext, we will calculate substitution rates ($K_a$, $K_s$, and $K_a/K_s$) for\nduplicate pairs in all selected species, namely:\n\n1. Three fungi species (*Saccharomyces cerevisiae*, *Candida glabrata*,\nand *Schizosaccharomyces pombe*).\n\n2. Four legume species (*Glycine max*, *Phaseolus vulgaris*, *Vitis vinifera*,\n*Selaginella moellendorffii*).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fungi - S. cerevisiae, Candida glabrata, and Schizosaccharomyces pombe\n## Download CDS\nselected_fungi <- c(\n    \"saccharomyces_cerevisiae\", \"candida_glabrata\", \"schizosaccharomyces_pombe\"\n)\nfungi_cds <- get_cds_ensembl(selected_fungi, ensembl = \"fungi\")\n\n## Calculate substitution rates\nfungi_kaks <- pairs2kaks(\n    gene_pairs_list = fungi_duplicates[selected_fungi],\n    cds = fungi_cds,\n    bp_param = BiocParallel::SnowParam(workers = 8)\n)\n\n# Plants - Glycine max, Phaseolus vulgaris, Vitis vinifera, and Selaginella moellendorffii\n## Download CDS\nselected_plants <- c(\n    \"glycine_max\", \"phaseolus_vulgaris\", \"vitis_vinifera\", \n    \"selaginella_moellendorffii\"\n)\n\nplants_cds <- get_cds_ensembl(selected_plants, ensembl = \"plants\")\n\n## Calculate substitution rates\nplants_duplicates <- plants_duplicates[selected_plants]\n\nplants_kaks <- pairs2kaks(\n    gene_pairs_list = plants_duplicates,\n    cds = plants_cds,\n    bp_param = BiocParallel::SnowParam(workers = 8)\n)\n```\n:::\n\n\nSaving objects as .rda files:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsave(\n    fungi_kaks, compress = \"xz\",\n    file = here(\"products\", \"result_files\", \"fungi_kaks.rda\")\n)\n\nsave(\n    plants_kaks, compress = \"xz\",\n    file = here(\"products\", \"result_files\", \"plants_kaks.rda\")\n)\n```\n:::\n\n\n## Session info {.unnumbered}\n\nThis document was created under the following conditions:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.2 (2023-10-31)\n os       Ubuntu 22.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/Brussels\n date     2024-02-27\n pandoc   3.1.1 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package              * version     date (UTC) lib source\n abind                  1.4-5       2016-07-21 [1] CRAN (R 4.3.2)\n ade4                   1.7-22      2023-02-06 [1] CRAN (R 4.3.2)\n AnnotationDbi          1.64.1      2023-11-03 [1] Bioconductor\n ape                    5.7-1       2023-03-13 [1] CRAN (R 4.3.2)\n Biobase                2.62.0      2023-10-24 [1] Bioconductor\n BiocFileCache          2.10.1      2023-10-26 [1] Bioconductor\n BiocGenerics           0.48.1      2023-11-01 [1] Bioconductor\n BiocIO                 1.12.0      2023-10-24 [1] Bioconductor\n BiocManager            1.30.22     2023-08-08 [1] CRAN (R 4.3.2)\n BiocParallel         * 1.37.0      2024-01-19 [1] Github (Bioconductor/BiocParallel@79a1b2d)\n BiocStyle              2.30.0      2023-10-24 [1] Bioconductor\n biomaRt                2.58.2      2024-01-30 [1] Bioconductor 3.18 (R 4.3.2)\n Biostrings             2.70.2      2024-01-28 [1] Bioconductor 3.18 (R 4.3.2)\n bit                    4.0.5       2022-11-15 [1] CRAN (R 4.3.2)\n bit64                  4.0.5       2020-08-30 [1] CRAN (R 4.3.2)\n bitops                 1.0-7       2021-04-24 [1] CRAN (R 4.3.2)\n blob                   1.2.4       2023-03-17 [1] CRAN (R 4.3.2)\n cachem                 1.0.8       2023-05-01 [1] CRAN (R 4.3.2)\n cli                    3.6.2       2023-12-11 [1] CRAN (R 4.3.2)\n coda                   0.19-4.1    2024-01-31 [1] CRAN (R 4.3.2)\n codetools              0.2-19      2023-02-01 [4] CRAN (R 4.2.2)\n colorspace             2.1-0       2023-01-23 [1] CRAN (R 4.3.2)\n crayon                 1.5.2       2022-09-29 [1] CRAN (R 4.3.2)\n curl                   5.2.0       2023-12-08 [1] CRAN (R 4.3.2)\n DBI                    1.2.1       2024-01-12 [1] CRAN (R 4.3.2)\n dbplyr                 2.4.0       2023-10-26 [1] CRAN (R 4.3.2)\n DelayedArray           0.28.0      2023-10-24 [1] Bioconductor\n digest                 0.6.34      2024-01-11 [1] CRAN (R 4.3.2)\n doParallel             1.0.17      2022-02-07 [1] CRAN (R 4.3.2)\n doubletrouble        * 1.3.4       2024-02-05 [1] Bioconductor\n dplyr                * 1.1.4       2023-11-17 [1] CRAN (R 4.3.2)\n evaluate               0.23        2023-11-01 [1] CRAN (R 4.3.2)\n fansi                  1.0.6       2023-12-08 [1] CRAN (R 4.3.2)\n fastmap                1.1.1       2023-02-24 [1] CRAN (R 4.3.2)\n filelock               1.0.3       2023-12-11 [1] CRAN (R 4.3.2)\n forcats              * 1.0.0       2023-01-29 [1] CRAN (R 4.3.2)\n foreach                1.5.2       2022-02-02 [1] CRAN (R 4.3.2)\n generics               0.1.3       2022-07-05 [1] CRAN (R 4.3.2)\n GenomeInfoDb           1.38.6      2024-02-08 [1] Bioconductor 3.18 (R 4.3.2)\n GenomeInfoDbData       1.2.11      2023-12-21 [1] Bioconductor\n GenomicAlignments      1.38.2      2024-01-16 [1] Bioconductor 3.18 (R 4.3.2)\n GenomicFeatures        1.54.3      2024-01-31 [1] Bioconductor 3.18 (R 4.3.2)\n GenomicRanges          1.54.1      2023-10-29 [1] Bioconductor\n ggnetwork              0.5.13      2024-02-14 [1] CRAN (R 4.3.2)\n ggplot2              * 3.4.4       2023-10-12 [1] CRAN (R 4.3.2)\n glue                   1.7.0       2024-01-09 [1] CRAN (R 4.3.2)\n gtable                 0.3.4       2023-08-21 [1] CRAN (R 4.3.2)\n here                 * 1.0.1       2020-12-13 [1] CRAN (R 4.3.2)\n hms                    1.1.3       2023-03-21 [1] CRAN (R 4.3.2)\n htmltools              0.5.7       2023-11-03 [1] CRAN (R 4.3.2)\n htmlwidgets            1.6.4       2023-12-06 [1] CRAN (R 4.3.2)\n httr                   1.4.7       2023-08-15 [1] CRAN (R 4.3.2)\n igraph                 2.0.1.1     2024-01-30 [1] CRAN (R 4.3.2)\n intergraph             2.0-4       2024-02-01 [1] CRAN (R 4.3.2)\n IRanges                2.36.0      2023-10-24 [1] Bioconductor\n iterators              1.0.14      2022-02-05 [1] CRAN (R 4.3.2)\n jsonlite               1.8.8       2023-12-04 [1] CRAN (R 4.3.2)\n KEGGREST               1.42.0      2023-10-24 [1] Bioconductor\n knitr                  1.45        2023-10-30 [1] CRAN (R 4.3.2)\n lattice                0.22-5      2023-10-24 [4] CRAN (R 4.3.1)\n lifecycle              1.0.4       2023-11-07 [1] CRAN (R 4.3.2)\n lubridate            * 1.9.3       2023-09-27 [1] CRAN (R 4.3.2)\n magrittr               2.0.3       2022-03-30 [1] CRAN (R 4.3.2)\n MASS                   7.3-60      2023-05-04 [4] CRAN (R 4.3.1)\n Matrix                 1.6-3       2023-11-14 [4] CRAN (R 4.3.2)\n MatrixGenerics         1.14.0      2023-10-24 [1] Bioconductor\n matrixStats            1.2.0       2023-12-11 [1] CRAN (R 4.3.2)\n mclust                 6.0.1       2023-11-15 [1] CRAN (R 4.3.2)\n memoise                2.0.1       2021-11-26 [1] CRAN (R 4.3.2)\n MSA2dist               1.6.0       2023-10-24 [1] Bioconductor\n munsell                0.5.0       2018-06-12 [1] CRAN (R 4.3.2)\n network                1.18.2      2023-12-05 [1] CRAN (R 4.3.2)\n networkD3              0.4         2017-03-18 [1] CRAN (R 4.3.2)\n nlme                   3.1-163     2023-08-09 [4] CRAN (R 4.3.1)\n pheatmap               1.0.12      2019-01-04 [1] CRAN (R 4.3.2)\n pillar                 1.9.0       2023-03-22 [1] CRAN (R 4.3.2)\n pkgconfig              2.0.3       2019-09-22 [1] CRAN (R 4.3.2)\n png                    0.1-8       2022-11-29 [1] CRAN (R 4.3.2)\n prettyunits            1.2.0       2023-09-24 [1] CRAN (R 4.3.2)\n progress               1.2.3       2023-12-06 [1] CRAN (R 4.3.2)\n purrr                * 1.0.2       2023-08-10 [1] CRAN (R 4.3.2)\n R6                     2.5.1       2021-08-19 [1] CRAN (R 4.3.2)\n rappdirs               0.3.3       2021-01-31 [1] CRAN (R 4.3.2)\n RColorBrewer           1.1-3       2022-04-03 [1] CRAN (R 4.3.2)\n Rcpp                   1.0.12      2024-01-09 [1] CRAN (R 4.3.2)\n RCurl                  1.98-1.14   2024-01-09 [1] CRAN (R 4.3.2)\n readr                * 2.1.5       2024-01-10 [1] CRAN (R 4.3.2)\n restfulr               0.0.15      2022-06-16 [1] CRAN (R 4.3.2)\n rjson                  0.2.21      2022-01-09 [1] CRAN (R 4.3.2)\n rlang                  1.1.3       2024-01-10 [1] CRAN (R 4.3.2)\n rmarkdown              2.25        2023-09-18 [1] CRAN (R 4.3.2)\n rprojroot              2.0.4       2023-11-05 [1] CRAN (R 4.3.2)\n Rsamtools              2.18.0      2023-10-24 [1] Bioconductor\n RSQLite                2.3.5       2024-01-21 [1] CRAN (R 4.3.2)\n rstudioapi             0.15.0      2023-07-07 [1] CRAN (R 4.3.2)\n rtracklayer            1.62.0      2023-10-24 [1] Bioconductor\n S4Arrays               1.2.0       2023-10-24 [1] Bioconductor\n S4Vectors              0.40.2      2023-11-23 [1] Bioconductor 3.18 (R 4.3.2)\n scales                 1.3.0       2023-11-28 [1] CRAN (R 4.3.2)\n seqinr                 4.2-36      2023-12-08 [1] CRAN (R 4.3.2)\n sessioninfo            1.2.2       2021-12-06 [1] CRAN (R 4.3.2)\n SparseArray            1.2.4       2024-02-11 [1] Bioconductor 3.18 (R 4.3.2)\n statnet.common         4.9.0       2023-05-24 [1] CRAN (R 4.3.2)\n stringi                1.8.3       2023-12-11 [1] CRAN (R 4.3.2)\n stringr              * 1.5.1       2023-11-14 [1] CRAN (R 4.3.2)\n SummarizedExperiment   1.32.0      2023-10-24 [1] Bioconductor\n syntenet             * 1.4.0       2023-10-24 [1] Bioconductor\n tibble               * 3.2.1       2023-03-20 [1] CRAN (R 4.3.2)\n tidyr                * 1.3.1       2024-01-24 [1] CRAN (R 4.3.2)\n tidyselect             1.2.0       2022-10-10 [1] CRAN (R 4.3.2)\n tidyverse            * 2.0.0       2023-02-22 [1] CRAN (R 4.3.2)\n timechange             0.3.0       2024-01-18 [1] CRAN (R 4.3.2)\n tzdb                   0.4.0       2023-05-12 [1] CRAN (R 4.3.2)\n utf8                   1.2.4       2023-10-22 [1] CRAN (R 4.3.2)\n vctrs                  0.6.5       2023-12-01 [1] CRAN (R 4.3.2)\n withr                  3.0.0       2024-01-16 [1] CRAN (R 4.3.2)\n xfun                   0.42        2024-02-08 [1] CRAN (R 4.3.2)\n XML                    3.99-0.16.1 2024-01-22 [1] CRAN (R 4.3.2)\n xml2                   1.3.6       2023-12-04 [1] CRAN (R 4.3.2)\n XVector                0.42.0      2023-10-24 [1] Bioconductor\n yaml                   2.3.8       2023-12-11 [1] CRAN (R 4.3.2)\n zlibbioc               1.48.0      2023-10-24 [1] Bioconductor\n\n [1] /home/faalm/R/x86_64-pc-linux-gnu-library/4.3\n [2] /usr/local/lib/R/site-library\n [3] /usr/lib/R/site-library\n [4] /usr/lib/R/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}